<div class="container wrapper">
	<div class="starter-template">
		<h1><img src="/img/tablet.png" alt="" />Mobile Controller</h1>
		<div class="mobile-buttons clearfix">
			<button type="button" class="blue-styled-button togglePlay">Pause</button>
			<button type="button" class="blue-styled-button skipBtn">Skip</button>
			<button type="button" class="blue-styled-button volBtn" id="up">Volume +</button>
			<button type="button" class="blue-styled-button volBtn" id="down">Volume -</button>
		</div>
		<div class="currentsong"></div>
		<div class="currentvolume"></div>
	</div>
</div>
<script src="https://ttv-api.s3.amazonaws.com/twitch.min.js"></script>
<script src="https://www.youtube.com/iframe_api"></script>
<script>
const channelName = getChannelName('{{=it.passedUser}}');
const channelData = buildChannelDataString(channelName);
loadSonglist(channelData,'');
async function initMobile() {
	const currentVolume = await getVolume(channelData);
	updateTextVolume(currentVolume);
	applyMusicStatus(channelData);
};
initMobile();
$.ajaxSetup({ cache: false });

$('.volBtn').click(async function(e) {
	e.preventDefault();
	const direction = $(this).attr('id');
	const currentVolume = await getVolume(channelData);
	let newVol;
	if (direction == 'up') {
		if (currentVolume < 90) {
			newVol = Number(currentVolume) + 10;
		} else {
			newVol = 100;
		};
	} else {
		if (currentVolume > 10) {
			newVol = currentVolume - 10;
		} else {
			newVol = 10;
		};
	};
	newVol = await updateVolume(channelData,newVol);
	updateTextVolume(newVol);
});

$('.togglePlay').click(async function(e) {
	e.preventDefault();
	if ($(this).text() == 'Pause') {
		await updateMusicStatus(channelData,'pause');
		$(this).text('Play');
	} else {
		await updateMusicStatus(channelData,'play');
		$(this).text('Pause');
	};
});

$('.skipBtn').click(function(e) {
	e.preventDefault();
	$.ajax({
		url: '/loadnextsong',
		data: channelData,
		type: 'POST',
		success: function(data) {
			loadSonglist(channelData,'');
		}
	});
});
</script>